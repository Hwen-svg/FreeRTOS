程序整体架构图
┌─────────────────────────────────────────────────────────────────┐
│                        APPLICATION LAYER                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │ sensor_Task │    │  oled_Task  │    │ JDY_TX_Task │         │
│  │ (采集任务)   │    │ (显示任务)   │    │ (蓝牙发送)  │         │
│  └──────┬──────┘    └──────┬──────┘    └──────┬──────┘         │
│         │                  │                  │                │
│  ┌──────▼──────┐    ┌──────▼──────┐    ┌──────▼──────┐         │
│  │sensor_Queue │    │ I2C_Mutex   │    │sensor_Queue │         │
│  │ (传感器队列) │    │ (I2C互斥锁)  │    │ (传感器队列) │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                      BLUETOOTH LAYER                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │JDY_RX_Task  │    │jdy31_RxTask │    │jdy31_TxTask │         │
│  │(蓝牙接收处理)│    │(JDY31接收)  │    │(JDY31发送)  │         │
│  └──────┬──────┘    └──────┬──────┘    └──────┬──────┘         │
│         │                  │                  │                │
│  ┌──────▼──────┐    ┌──────▼──────┐    ┌──────▼──────┐         │
│  │JDY_RX_Queue │    │ UART_Mutex  │    │JDY_TX_Queue │         │
│  │(蓝牙接收队列)│    │(UART互斥锁) │    │(蓝牙发送队列)│         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                        DRIVER LAYER                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────┐│
│  │   DHT11     │  │    ADC      │  │   OLED      │  │  BUZZER ││
│  │ (温湿度传感器)│  │ (光照传感器) │  │   (显示)    │  │ (蜂鸣器) ││
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────┘│
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                        HARDWARE LAYER                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────┐│
│  │    I2C1     │  │    USART1   │  │    USART2   │  │   GPIO  ││
│  │ (OLED通信)   │  │ (调试串口)   │  │ (蓝牙通信)   │  │ (通用IO) ││
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────┘│
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
数据流架构图
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   sensor_Task   │    │   sensor_Queue   │    │   oled_Task     │
│                 │    │                  │    │                 │
│ • 读取DHT11     │───▶│ • 温度数据       │───▶│ • 获取I2C锁     │
│ • 读取ADC       │    │ • 湿度数据       │    │ • OLED显示      │
│ • 发送到队列     │    │ • 光照数据       │    │ • 释放I2C锁     │
└─────────────────┘    └──────────────────┘    └─────────────────┘
         │                        │                        │
         │                        │                        │
         ▼                        ▼                        ▼
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│  JDY_TX_Task    │    │   JDY_TX_Queue   │    │  jdy31_TxTask   │
│                 │    │                  │    │                 │
│ • 从队列获取数据 │───▶│ • 格式化数据     │───▶│ • 获取UART锁    │
│ • 格式化发送     │    │ • 发送到蓝牙     │    │ • 串口发送      │
└─────────────────┘    └──────────────────┘    └─────────────────┘
         │                        │                        │
         │                        │                        │
         ▼                        ▼                        ▼
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│  jdy31_RxTask   │    │   JDY_RX_Queue   │    │   JDY_RX_Task   │
│                 │    │                  │    │                 │
│ • 串口接收数据   │───▶│ • 接收数据帧     │───▶│ • 获取I2C锁     │
│ • 解析数据帧     │    │ • 连接状态       │    │ • OLED显示状态  │
│                 │    │                  │    │ • 释放I2C锁     │
└─────────────────┘    └──────────────────┘    └─────────────────┘
任务优先级架构
优先级 High
    │
    ├── jdy31_RxTask        (蓝牙接收处理)
    │
优先级 AboveNormal  
    │
    ├── JDY_RX_Task         (蓝牙数据应用处理)
    │
优先级 Normal
    │
    ├── oled_Task           (OLED显示)
    ├── jdy31_TxTask        (蓝牙发送)
    ├── feng_Task           (蜂鸣器控制) - 注释状态
    │
优先级 BelowNormal
    │
    ├── sensor_Task         (传感器采集)
    ├── JDY_TX_Task         (蓝牙数据发送)
    │
    ▼
资源保护架构
┌─────────────────────────────────────────────────┐
│              RESOURCE PROTECTION                │
├─────────────────────────────────────────────────┤
│                                                 │
│  I2C Bus (OLED Access)                          │
│  ┌─────────────┐        ┌─────────────┐        │
│  │  oled_Task  │        │ JDY_RX_Task │        │
│  └──────┬──────┘        └──────┬──────┘        │
│         │                      │               │
│         └──────────┬───────────┘               │
│                    │                           │
│             ┌──────▼──────┐                    │
│             │ I2C_Mutex   │                    │
│             │ (互斥锁)     │                    │
│             └─────────────┘                    │
│                                                 │
│  UART Bus (Bluetooth Communication)            │
│  ┌─────────────┐        ┌─────────────┐        │
│  │jdy31_RxTask │        │jdy31_TxTask │        │
│  └──────┬──────┘        └──────┬──────┘        │
│         │                      │               │
│         └──────────┬───────────┘               │
│                    │                           │
│             ┌──────▼──────┐                    │
│             │ UART_Mutex  │                    │
│             │ (互斥锁)     │                    │
│             └─────────────┘                    │
│                                                 │
└─────────────────────────────────────────────────┘
